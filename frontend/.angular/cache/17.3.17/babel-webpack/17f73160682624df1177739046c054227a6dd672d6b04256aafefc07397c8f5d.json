{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class ThresholdService {\n  // Uncomment this when you are ready to connect to your Node.js API\n  // private apiUrl = 'http://localhost:3000/api/thresholds';\n  // constructor(private http: HttpClient) { }\n  constructor() {\n    // 1. Setup Initial State (Defaulting to 50 based on your screenshot's placeholder)\n    this.initialSettings = {\n      crowdLimitPerGate: 50\n    };\n    // 2. Create a reactive stream (BehaviorSubject) holding the threshold data\n    this.thresholdSubject = new BehaviorSubject(this.initialSettings);\n    // Expose the stream as an Observable so components can subscribe to it\n    this.threshold$ = this.thresholdSubject.asObservable();\n  }\n  /**\n   * Fetch the current threshold settings (Reactive)\n   */\n  getThresholds() {\n    return this.threshold$;\n    // BACKEND INTEGRATION READY:\n    // return this.http.get<ThresholdSettings>(this.apiUrl);\n  }\n  /**\n   * Get the current value instantly without subscribing (useful for one-off checks)\n   */\n  getCurrentLimit() {\n    return this.thresholdSubject.getValue().crowdLimitPerGate;\n  }\n  /**\n   * Update the system threshold limit\n   */\n  updateThreshold(newLimit) {\n    const updatedSettings = {\n      crowdLimitPerGate: newLimit\n    };\n    // Broadcast the new limit to all subscribed components\n    this.thresholdSubject.next(updatedSettings);\n    // BACKEND INTEGRATION READY:\n    // return this.http.put<ThresholdSettings>(this.apiUrl, updatedSettings).subscribe(\n    //   res => console.log('Threshold saved to database:', res),\n    //   err => console.error('Failed to save threshold:', err)\n    // );\n  }\n  static {\n    this.ɵfac = function ThresholdService_Factory(t) {\n      return new (t || ThresholdService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: ThresholdService,\n      factory: ThresholdService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","ThresholdService","constructor","initialSettings","crowdLimitPerGate","thresholdSubject","threshold$","asObservable","getThresholds","getCurrentLimit","getValue","updateThreshold","newLimit","updatedSettings","next","factory","ɵfac","providedIn"],"sources":["C:\\Users\\sanja\\OneDrive\\Desktop\\crowdguardai\\frontend\\src\\app\\services\\threshold.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http'; // Ready for your Node.js backend\n\nexport interface ThresholdSettings {\n  crowdLimitPerGate: number | null;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ThresholdService {\n\n  // 1. Setup Initial State (Defaulting to 50 based on your screenshot's placeholder)\n  private initialSettings: ThresholdSettings = {\n    crowdLimitPerGate: 50 \n  };\n\n  // 2. Create a reactive stream (BehaviorSubject) holding the threshold data\n  private thresholdSubject = new BehaviorSubject<ThresholdSettings>(this.initialSettings);\n  \n  // Expose the stream as an Observable so components can subscribe to it\n  public threshold$ = this.thresholdSubject.asObservable();\n\n  // Uncomment this when you are ready to connect to your Node.js API\n  // private apiUrl = 'http://localhost:3000/api/thresholds';\n  // constructor(private http: HttpClient) { }\n\n  constructor() { }\n\n  /**\n   * Fetch the current threshold settings (Reactive)\n   */\n  getThresholds(): Observable<ThresholdSettings> {\n    return this.threshold$;\n\n    // BACKEND INTEGRATION READY:\n    // return this.http.get<ThresholdSettings>(this.apiUrl);\n  }\n\n  /**\n   * Get the current value instantly without subscribing (useful for one-off checks)\n   */\n  getCurrentLimit(): number | null {\n    return this.thresholdSubject.getValue().crowdLimitPerGate;\n  }\n\n  /**\n   * Update the system threshold limit\n   */\n  updateThreshold(newLimit: number) {\n    const updatedSettings: ThresholdSettings = {\n      crowdLimitPerGate: newLimit\n    };\n\n    // Broadcast the new limit to all subscribed components\n    this.thresholdSubject.next(updatedSettings);\n\n    // BACKEND INTEGRATION READY:\n    // return this.http.put<ThresholdSettings>(this.apiUrl, updatedSettings).subscribe(\n    //   res => console.log('Threshold saved to database:', res),\n    //   err => console.error('Failed to save threshold:', err)\n    // );\n  }\n}"],"mappings":"AACA,SAASA,eAAe,QAAoB,MAAM;;AAUlD,OAAM,MAAOC,gBAAgB;EAa3B;EACA;EACA;EAEAC,YAAA;IAfA;IACQ,KAAAC,eAAe,GAAsB;MAC3CC,iBAAiB,EAAE;KACpB;IAED;IACQ,KAAAC,gBAAgB,GAAG,IAAIL,eAAe,CAAoB,IAAI,CAACG,eAAe,CAAC;IAEvF;IACO,KAAAG,UAAU,GAAG,IAAI,CAACD,gBAAgB,CAACE,YAAY,EAAE;EAMxC;EAEhB;;;EAGAC,aAAaA,CAAA;IACX,OAAO,IAAI,CAACF,UAAU;IAEtB;IACA;EACF;EAEA;;;EAGAG,eAAeA,CAAA;IACb,OAAO,IAAI,CAACJ,gBAAgB,CAACK,QAAQ,EAAE,CAACN,iBAAiB;EAC3D;EAEA;;;EAGAO,eAAeA,CAACC,QAAgB;IAC9B,MAAMC,eAAe,GAAsB;MACzCT,iBAAiB,EAAEQ;KACpB;IAED;IACA,IAAI,CAACP,gBAAgB,CAACS,IAAI,CAACD,eAAe,CAAC;IAE3C;IACA;IACA;IACA;IACA;EACF;;;uBApDWZ,gBAAgB;IAAA;EAAA;;;aAAhBA,gBAAgB;MAAAc,OAAA,EAAhBd,gBAAgB,CAAAe,IAAA;MAAAC,UAAA,EAFf;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}