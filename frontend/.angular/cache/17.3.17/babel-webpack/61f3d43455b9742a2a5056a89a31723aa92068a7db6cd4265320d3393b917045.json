{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction CameraSetupComponent_div_14_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelement(0, \"span\", 27);\n  }\n}\nfunction CameraSetupComponent_div_14_button_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"button\", 28);\n    i0.…µ…µlistener(\"click\", function CameraSetupComponent_div_14_button_17_Template_button_click_0_listener() {\n      i0.…µ…µrestoreView(_r3);\n      const cam_r2 = i0.…µ…µnextContext().$implicit;\n      const ctx_r3 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r3.removeCamera(cam_r2));\n    });\n    i0.…µ…µnamespaceSVG();\n    i0.…µ…µelementStart(1, \"svg\", 29);\n    i0.…µ…µelement(2, \"path\", 30);\n    i0.…µ…µelementEnd();\n    i0.…µ…µtext(3, \" Remove \");\n    i0.…µ…µelementEnd();\n  }\n}\nfunction CameraSetupComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 11)(1, \"div\", 12)(2, \"h3\", 13);\n    i0.…µ…µtext(3);\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(4, \"span\", 14);\n    i0.…µ…µtemplate(5, CameraSetupComponent_div_14_span_5_Template, 1, 0, \"span\", 15);\n    i0.…µ…µtext(6);\n    i0.…µ…µpipe(7, \"uppercase\");\n    i0.…µ…µelementEnd()();\n    i0.…µ…µelementStart(8, \"div\", 16)(9, \"label\", 17);\n    i0.…µ…µtext(10, \"Network Stream URL (RTSP / HTTP)\");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(11, \"div\", 18)(12, \"div\", 19);\n    i0.…µ…µnamespaceSVG();\n    i0.…µ…µelementStart(13, \"svg\", 20);\n    i0.…µ…µelement(14, \"path\", 21);\n    i0.…µ…µelementEnd()();\n    i0.…µ…µnamespaceHTML();\n    i0.…µ…µelementStart(15, \"input\", 22);\n    i0.…µ…µtwoWayListener(\"ngModelChange\", function CameraSetupComponent_div_14_Template_input_ngModelChange_15_listener($event) {\n      const cam_r2 = i0.…µ…µrestoreView(_r1).$implicit;\n      i0.…µ…µtwoWayBindingSet(cam_r2.rtsp_url, $event) || (cam_r2.rtsp_url = $event);\n      return i0.…µ…µresetView($event);\n    });\n    i0.…µ…µelementEnd()()();\n    i0.…µ…µelementStart(16, \"div\", 23);\n    i0.…µ…µtemplate(17, CameraSetupComponent_div_14_button_17_Template, 4, 0, \"button\", 24);\n    i0.…µ…µelementStart(18, \"button\", 25);\n    i0.…µ…µlistener(\"click\", function CameraSetupComponent_div_14_Template_button_click_18_listener() {\n      const cam_r2 = i0.…µ…µrestoreView(_r1).$implicit;\n      const ctx_r3 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r3.testConnection(cam_r2));\n    });\n    i0.…µ…µtext(19, \" Ping Camera \");\n    i0.…µ…µelementEnd();\n    i0.…µ…µelementStart(20, \"button\", 26);\n    i0.…µ…µlistener(\"click\", function CameraSetupComponent_div_14_Template_button_click_20_listener() {\n      const cam_r2 = i0.…µ…µrestoreView(_r1).$implicit;\n      const ctx_r3 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r3.saveCamera(cam_r2));\n    });\n    i0.…µ…µtext(21);\n    i0.…µ…µelementEnd()()();\n  }\n  if (rf & 2) {\n    const cam_r2 = ctx.$implicit;\n    i0.…µ…µadvance(3);\n    i0.…µ…µtextInterpolate(cam_r2.gate);\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngClass\", cam_r2.status === \"Live\" ? \"bg-green-900/50 text-green-400 border-green-700\" : \"bg-slate-800 text-slate-400 border-slate-600\");\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"ngIf\", cam_r2.status === \"Live\");\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate1(\" \", i0.…µ…µpipeBind1(7, 8, cam_r2.status), \" \");\n    i0.…µ…µadvance(9);\n    i0.…µ…µtwoWayProperty(\"ngModel\", cam_r2.rtsp_url);\n    i0.…µ…µadvance(2);\n    i0.…µ…µproperty(\"ngIf\", cam_r2.status === \"Live\" || cam_r2.rtsp_url);\n    i0.…µ…µadvance(3);\n    i0.…µ…µproperty(\"disabled\", cam_r2.isSaving);\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate1(\" \", cam_r2.isSaving ? \"Saving...\" : \"Save Configuration\", \" \");\n  }\n}\nexport let CameraSetupComponent = /*#__PURE__*/(() => {\n  class CameraSetupComponent {\n    constructor(http) {\n      this.http = http;\n      this.cameraNodes = [];\n      this.userEmail = '';\n    }\n    ngOnInit() {\n      this.userEmail = localStorage.getItem('userEmail') || '';\n      this.loadSavedCameras();\n    }\n    loadSavedCameras() {\n      if (!this.userEmail) return;\n      this.http.get(`http://localhost:8000/api/cameras?user_email=${this.userEmail}`).subscribe({\n        next: savedCams => {\n          if (savedCams.length > 0) {\n            this.cameraNodes = savedCams.map(cam => ({\n              gate: cam.gate,\n              rtsp_url: cam.rtsp_url === '0' ? '0' : cam.rtsp_url,\n              status: cam.status,\n              isSaving: false\n            }));\n          } else {\n            for (let i = 1; i <= 5; i++) {\n              this.cameraNodes.push({\n                gate: `Gate ${i}`,\n                rtsp_url: '',\n                status: 'Offline',\n                isSaving: false\n              });\n            }\n          }\n        },\n        error: err => console.error(\"Could not load cameras\", err)\n      });\n    }\n    addNewGate() {\n      const nextNumber = this.cameraNodes.length + 1;\n      this.cameraNodes.push({\n        gate: `Gate ${nextNumber}`,\n        rtsp_url: '',\n        status: 'Offline',\n        isSaving: false\n      });\n    }\n    saveCamera(cam) {\n      if (!this.userEmail) {\n        alert(\"Please Logout and Login again to sync your account.\");\n        return;\n      }\n      cam.isSaving = true;\n      const payload = {\n        gate: cam.gate || `Unknown Gate`,\n        rtsp_url: cam.rtsp_url || \"0\",\n        status: cam.rtsp_url || cam.rtsp_url === \"0\" ? 'Live' : 'Offline',\n        user_email: this.userEmail\n      };\n      this.http.post('http://localhost:8000/api/cameras', payload).subscribe({\n        next: res => {\n          cam.isSaving = false;\n          cam.status = payload.status;\n          cam.rtsp_url = payload.rtsp_url;\n          alert(`‚úÖ ${cam.gate} network node created & saved for your account!`);\n        },\n        error: err => {\n          cam.isSaving = false;\n          alert(\"‚ùå Failed to save to database. Check terminal for details.\");\n        }\n      });\n    }\n    // --- NEW: FUNCTION TO REMOVE CAMERA ---\n    removeCamera(cam) {\n      if (!confirm(`Are you sure you want to remove the camera stream from ${cam.gate}?`)) {\n        return; // Cancel the delete if user clicks \"No\"\n      }\n      cam.isSaving = true;\n      // We send an EMPTY URL to overwrite the database!\n      const payload = {\n        gate: cam.gate,\n        rtsp_url: \"\",\n        status: \"Offline\",\n        user_email: this.userEmail\n      };\n      this.http.post('http://localhost:8000/api/cameras', payload).subscribe({\n        next: res => {\n          cam.isSaving = false;\n          cam.status = \"Offline\";\n          cam.rtsp_url = \"\"; // Clear the UI box\n          alert(`üóëÔ∏è Camera removed from ${cam.gate} successfully!`);\n        },\n        error: err => {\n          cam.isSaving = false;\n          alert(\"‚ùå Failed to remove camera.\");\n        }\n      });\n    }\n    testConnection(cam) {\n      if (!cam.rtsp_url) {\n        alert(\"Please enter an RTSP URL first.\");\n        return;\n      }\n      alert(`üì° Pinging ${cam.rtsp_url}... \\nConnection successful!`);\n    }\n    static {\n      this.…µfac = function CameraSetupComponent_Factory(t) {\n        return new (t || CameraSetupComponent)(i0.…µ…µdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.…µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n        type: CameraSetupComponent,\n        selectors: [[\"app-camera-setup\"]],\n        decls: 15,\n        vars: 1,\n        consts: [[1, \"p-6\"], [1, \"flex\", \"justify-between\", \"items-center\", \"mb-8\"], [1, \"text-3xl\", \"font-extrabold\", \"text-white\", \"flex\", \"items-center\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-8\", \"h-8\", \"mr-3\", \"text-blue-500\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1\"], [1, \"text-slate-400\", \"mt-2\", \"ml-11\"], [1, \"bg-teal-600\", \"hover:bg-teal-500\", \"text-white\", \"font-bold\", \"py-3\", \"px-6\", \"rounded-lg\", \"flex\", \"items-center\", \"shadow-lg\", \"transition-colors\", 3, \"click\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-5\", \"h-5\", \"mr-2\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 4v16m8-8H4\"], [1, \"grid\", \"grid-cols-1\", \"lg:grid-cols-2\", \"gap-6\"], [\"class\", \"bg-[#1e293b] rounded-2xl p-6 border border-slate-700 shadow-xl relative overflow-hidden\", 4, \"ngFor\", \"ngForOf\"], [1, \"bg-[#1e293b]\", \"rounded-2xl\", \"p-6\", \"border\", \"border-slate-700\", \"shadow-xl\", \"relative\", \"overflow-hidden\"], [1, \"flex\", \"justify-between\", \"items-center\", \"mb-4\"], [1, \"text-xl\", \"font-bold\", \"text-white\"], [1, \"px-3\", \"py-1\", \"rounded-full\", \"text-xs\", \"font-bold\", \"border\", \"flex\", \"items-center\", 3, \"ngClass\"], [\"class\", \"w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse\", 4, \"ngIf\"], [1, \"mb-6\"], [1, \"block\", \"text-slate-400\", \"text-xs\", \"font-bold\", \"mb-2\", \"uppercase\", \"tracking-wide\"], [1, \"flex\", \"items-center\", \"bg-[#0f172a]\", \"border\", \"border-slate-600\", \"rounded-lg\", \"overflow-hidden\", \"focus-within:border-blue-500\", \"transition-colors\"], [1, \"px-4\", \"text-slate-400\", \"border-r\", \"border-slate-600\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-5\", \"h-5\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9\"], [\"type\", \"text\", \"placeholder\", \"e.g., 0 for Webcam or http://192.0.0.4:8080/video\", 1, \"w-full\", \"bg-transparent\", \"text-white\", \"p-3\", \"outline-none\", 3, \"ngModelChange\", \"ngModel\"], [1, \"flex\", \"justify-end\", \"items-center\", \"space-x-4\"], [\"class\", \"text-red-400 hover:text-red-300 font-bold text-sm transition-colors flex items-center mr-auto\", 3, \"click\", 4, \"ngIf\"], [1, \"text-blue-400\", \"hover:text-blue-300\", \"font-bold\", \"text-sm\", \"transition-colors\", 3, \"click\"], [1, \"bg-blue-600\", \"hover:bg-blue-500\", \"text-white\", \"font-bold\", \"py-2\", \"px-6\", \"rounded-lg\", \"transition-colors\", \"disabled:opacity-50\", \"shadow-md\", 3, \"click\", \"disabled\"], [1, \"w-2\", \"h-2\", \"rounded-full\", \"bg-green-500\", \"mr-2\", \"animate-pulse\"], [1, \"text-red-400\", \"hover:text-red-300\", \"font-bold\", \"text-sm\", \"transition-colors\", \"flex\", \"items-center\", \"mr-auto\", 3, \"click\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-4\", \"h-4\", \"mr-1\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"]],\n        template: function CameraSetupComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.…µ…µelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\")(3, \"h1\", 2);\n            i0.…µ…µnamespaceSVG();\n            i0.…µ…µelementStart(4, \"svg\", 3);\n            i0.…µ…µelement(5, \"path\", 4);\n            i0.…µ…µelementEnd();\n            i0.…µ…µtext(6, \" RTSP Network Nodes \");\n            i0.…µ…µelementEnd();\n            i0.…µ…µnamespaceHTML();\n            i0.…µ…µelementStart(7, \"p\", 5);\n            i0.…µ…µtext(8, \"Configure live IP camera streams (rtsp://) for automated AI monitoring.\");\n            i0.…µ…µelementEnd()();\n            i0.…µ…µelementStart(9, \"button\", 6);\n            i0.…µ…µlistener(\"click\", function CameraSetupComponent_Template_button_click_9_listener() {\n              return ctx.addNewGate();\n            });\n            i0.…µ…µnamespaceSVG();\n            i0.…µ…µelementStart(10, \"svg\", 7);\n            i0.…µ…µelement(11, \"path\", 8);\n            i0.…µ…µelementEnd();\n            i0.…µ…µtext(12, \" Add New Camera Node \");\n            i0.…µ…µelementEnd()();\n            i0.…µ…µnamespaceHTML();\n            i0.…µ…µelementStart(13, \"div\", 9);\n            i0.…µ…µtemplate(14, CameraSetupComponent_div_14_Template, 22, 10, \"div\", 10);\n            i0.…µ…µelementEnd()();\n          }\n          if (rf & 2) {\n            i0.…µ…µadvance(14);\n            i0.…µ…µproperty(\"ngForOf\", ctx.cameraNodes);\n          }\n        },\n        dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i2.UpperCasePipe]\n      });\n    }\n  }\n  return CameraSetupComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}