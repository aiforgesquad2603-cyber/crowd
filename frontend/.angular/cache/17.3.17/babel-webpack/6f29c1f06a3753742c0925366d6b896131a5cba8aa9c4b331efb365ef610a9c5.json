{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../shared/glass-card/glass-card.component\";\nconst _c0 = (a0, a1, a2, a3) => ({\n  \"border-l-red-500\": a0,\n  \"border-l-orange-500\": a1,\n  \"border-l-yellow-500\": a2,\n  \"border-l-green-500\": a3\n});\nconst _c1 = (a0, a1, a2, a3) => ({\n  \"bg-red-500/20 text-red-500\": a0,\n  \"bg-orange-500/20 text-orange-500\": a1,\n  \"bg-yellow-500/20 text-yellow-500\": a2,\n  \"bg-green-500/20 text-green-500\": a3\n});\nconst _c2 = (a0, a1, a2) => ({\n  \"text-green-400\": a0,\n  \"text-yellow-500\": a1,\n  \"text-blue-400\": a2\n});\nfunction GuardAssignComponent_div_24_option_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"option\", 37);\n    i0.ÉµÉµtext(1);\n    i0.ÉµÉµelementEnd();\n  }\n  if (rf & 2) {\n    const guard_r3 = ctx.$implicit;\n    i0.ÉµÉµproperty(\"value\", guard_r3.id);\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate2(\" \", guard_r3.name, \" (\", guard_r3.gate, \") \");\n  }\n}\nfunction GuardAssignComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementStart(0, \"div\", 26)(1, \"div\", 27)(2, \"div\")(3, \"h4\", 28);\n    i0.ÉµÉµtext(4);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(5, \"p\", 29);\n    i0.ÉµÉµtext(6, \"Units Deployed: \");\n    i0.ÉµÉµelementStart(7, \"span\", 30);\n    i0.ÉµÉµtext(8);\n    i0.ÉµÉµelementEnd()()();\n    i0.ÉµÉµelementStart(9, \"span\", 31);\n    i0.ÉµÉµtext(10);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(11, \"div\", 32)(12, \"select\", 33);\n    i0.ÉµÉµtwoWayListener(\"ngModelChange\", function GuardAssignComponent_div_24_Template_select_ngModelChange_12_listener($event) {\n      const zone_r2 = i0.ÉµÉµrestoreView(_r1).$implicit;\n      i0.ÉµÉµtwoWayBindingSet(zone_r2.selectedGuard, $event) || (zone_r2.selectedGuard = $event);\n      return i0.ÉµÉµresetView($event);\n    });\n    i0.ÉµÉµelementStart(13, \"option\", 34);\n    i0.ÉµÉµtext(14, \"Select available unit...\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµtemplate(15, GuardAssignComponent_div_24_option_15_Template, 2, 3, \"option\", 35);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(16, \"button\", 36);\n    i0.ÉµÉµlistener(\"click\", function GuardAssignComponent_div_24_Template_button_click_16_listener() {\n      const zone_r2 = i0.ÉµÉµrestoreView(_r1).$implicit;\n      const ctx_r3 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r3.dispatchGuard(zone_r2));\n    });\n    i0.ÉµÉµtext(17, \" Dispatch \");\n    i0.ÉµÉµelementEnd()()();\n  }\n  if (rf & 2) {\n    const zone_r2 = ctx.$implicit;\n    const ctx_r3 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµproperty(\"ngClass\", i0.ÉµÉµpureFunction4(7, _c0, zone_r2.risk === \"Critical\", zone_r2.risk === \"High\", zone_r2.risk === \"Moderate\", zone_r2.risk === \"Low\"));\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate(zone_r2.name);\n    i0.ÉµÉµadvance(4);\n    i0.ÉµÉµtextInterpolate(zone_r2.deployed);\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngClass\", i0.ÉµÉµpureFunction4(12, _c1, zone_r2.risk === \"Critical\", zone_r2.risk === \"High\", zone_r2.risk === \"Moderate\", zone_r2.risk === \"Low\"));\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate1(\" \", zone_r2.risk, \" \");\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtwoWayProperty(\"ngModel\", zone_r2.selectedGuard);\n    i0.ÉµÉµadvance(3);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r3.getAvailableGuards());\n  }\n}\nfunction GuardAssignComponent_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 38);\n    i0.ÉµÉµtext(1, \" No guards registered. \");\n    i0.ÉµÉµelement(2, \"br\");\n    i0.ÉµÉµtext(3, \" Add them in Settings. \");\n    i0.ÉµÉµelementEnd();\n  }\n}\nfunction GuardAssignComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 39)(1, \"div\")(2, \"p\", 40);\n    i0.ÉµÉµtext(3);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(4, \"p\", 41);\n    i0.ÉµÉµtext(5);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(6, \"span\", 42);\n    i0.ÉµÉµtext(7);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const guard_r5 = ctx.$implicit;\n    i0.ÉµÉµadvance(3);\n    i0.ÉµÉµtextInterpolate(guard_r5.name);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate2(\"\", guard_r5.mobile, \" | \", guard_r5.gate, \"\");\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµproperty(\"ngClass\", i0.ÉµÉµpureFunction3(5, _c2, guard_r5.status === \"Active\", guard_r5.status === \"On Break\", guard_r5.status === \"Responding\"));\n    i0.ÉµÉµadvance();\n    i0.ÉµÉµtextInterpolate1(\" \", guard_r5.status, \" \");\n  }\n}\nexport let GuardAssignComponent = /*#__PURE__*/(() => {\n  class GuardAssignComponent {\n    constructor(http) {\n      this.http = http;\n      // We updated the names to match your real gates!\n      this.zones = [{\n        id: 'Z1',\n        name: 'Gate 1',\n        risk: 'Critical',\n        deployed: 2,\n        selectedGuard: ''\n      }, {\n        id: 'Z2',\n        name: 'Gate 2',\n        risk: 'High',\n        deployed: 1,\n        selectedGuard: ''\n      }, {\n        id: 'Z3',\n        name: 'Gate 3',\n        risk: 'Moderate',\n        deployed: 0,\n        selectedGuard: ''\n      }, {\n        id: 'Z4',\n        name: 'Gate 4',\n        risk: 'Low',\n        deployed: 1,\n        selectedGuard: ''\n      }];\n      // This will now hold your REAL guards from MongoDB\n      this.guards = [];\n      // --- NEW: Multi-tenant Account ID ---\n      this.userEmail = '';\n    }\n    ngOnInit() {\n      // 1. Securely fetch the logged-in user's email\n      this.userEmail = localStorage.getItem('userEmail') || '';\n      // Automatically fetch real guards when the page opens!\n      this.loadRealGuards();\n    }\n    loadRealGuards() {\n      if (!this.userEmail) return; // Stop if no email\n      // 2. Pass the user_email to the backend to get ONLY their guards\n      this.http.get(`http://localhost:8000/api/guards?user_email=${this.userEmail}`).subscribe({\n        next: data => {\n          this.guards = data;\n        },\n        error: err => {\n          console.error(\"Failed to load real guards from database\", err);\n        }\n      });\n    }\n    // Only show guards who are 'Active' in the dropdown menu\n    getAvailableGuards() {\n      return this.guards.filter(guard => guard.status === 'Active');\n    }\n    dispatchGuard(zone) {\n      if (!zone.selectedGuard) {\n        alert('Please select an available unit first!');\n        return;\n      }\n      // Find the real guard using their unique MongoDB ID\n      const guard = this.guards.find(g => g.id === zone.selectedGuard);\n      if (guard) {\n        guard.status = 'Responding'; // Update status to red instantly\n        zone.deployed += 1;\n        alert(`ðŸš¨ Dispatching ${guard.name} to ${zone.name} immediately.`);\n      }\n      // Reset the dropdown\n      zone.selectedGuard = '';\n    }\n    broadcastMessage() {\n      alert(\"ðŸ“¢ Broadcasting emergency message to all active units...\");\n    }\n    static {\n      this.Éµfac = function GuardAssignComponent_Factory(t) {\n        return new (t || GuardAssignComponent)(i0.ÉµÉµdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n        type: GuardAssignComponent,\n        selectors: [[\"app-guard-assign\"]],\n        decls: 40,\n        vars: 3,\n        consts: [[1, \"min-h-screen\", \"bg-gradient-to-br\", \"from-[#0f172a]\", \"via-[#1e293b]\", \"to-[#0f172a]\", \"p-6\", \"lg:p-8\", \"font-sans\", \"text-gray-300\"], [1, \"flex\", \"justify-between\", \"items-center\", \"mb-8\"], [1, \"text-3xl\", \"font-bold\", \"text-white\", \"tracking-wide\"], [1, \"text-sm\", \"text-gray-400\", \"mt-1\"], [1, \"flex\", \"space-x-4\"], [1, \"bg-[#1e293b]\", \"hover:bg-slate-700\", \"text-gray-300\", \"border\", \"border-slate-600\", \"px-4\", \"py-2\", \"rounded-lg\", \"text-sm\", \"font-medium\", \"transition-colors\", 3, \"click\"], [1, \"bg-blue-600\", \"hover:bg-blue-500\", \"text-white\", \"px-4\", \"py-2\", \"rounded-lg\", \"text-sm\", \"font-medium\", \"transition-colors\", \"flex\", \"items-center\", \"shadow-[0_0_10px_rgba(37,99,235,0.4)]\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-4\", \"h-4\", \"mr-1\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 4v16m8-8H4\"], [1, \"grid\", \"grid-cols-1\", \"lg:grid-cols-3\", \"gap-6\"], [1, \"lg:col-span-2\"], [\"customClasses\", \"p-6 h-full\"], [1, \"flex\", \"items-center\", \"mb-6\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-5\", \"h-5\", \"text-orange-400\", \"mr-2\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M15 11a3 3 0 11-6 0 3 3 0 016 0z\"], [1, \"text-lg\", \"font-semibold\", \"text-white\"], [1, \"space-y-4\"], [\"class\", \"bg-[#0f172a]/80 p-5 rounded-lg border border-slate-700/50 border-l-4\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"lg:col-span-1\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-5\", \"h-5\", \"text-blue-400\", \"mr-2\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\"], [1, \"flex\", \"justify-between\", \"text-xs\", \"font-semibold\", \"text-gray-500\", \"uppercase\", \"tracking-wider\", \"border-b\", \"border-slate-700/50\", \"pb-2\", \"mb-3\", \"px-2\"], [\"class\", \"text-center text-gray-500 py-6 text-sm\", 4, \"ngIf\"], [1, \"space-y-1\"], [\"class\", \"flex justify-between items-center p-3 rounded-md hover:bg-[#1e293b] transition-colors border border-transparent hover:border-slate-700/50\", 4, \"ngFor\", \"ngForOf\"], [1, \"bg-[#0f172a]/80\", \"p-5\", \"rounded-lg\", \"border\", \"border-slate-700/50\", \"border-l-4\", 3, \"ngClass\"], [1, \"flex\", \"justify-between\", \"items-start\", \"mb-3\"], [1, \"text-lg\", \"font-bold\", \"text-white\"], [1, \"text-xs\", \"text-gray-400\", \"mt-1\"], [1, \"font-bold\", \"text-gray-200\"], [1, \"px-3\", \"py-1\", \"text-xs\", \"font-bold\", \"rounded-md\", \"uppercase\", \"tracking-wide\", 3, \"ngClass\"], [1, \"flex\", \"items-center\", \"space-x-3\", \"mt-4\"], [1, \"flex-1\", \"bg-[#1e293b]\", \"border\", \"border-slate-600\", \"rounded-lg\", \"px-3\", \"py-2\", \"text-sm\", \"text-gray-300\", \"outline-none\", \"focus:border-blue-500\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"bg-[#1e3a8a]/40\", \"hover:bg-[#1e3a8a]/80\", \"border\", \"border-blue-600/50\", \"text-blue-400\", \"px-5\", \"py-2\", \"rounded-lg\", \"text-sm\", \"font-semibold\", \"transition-colors\", 3, \"click\"], [3, \"value\"], [1, \"text-center\", \"text-gray-500\", \"py-6\", \"text-sm\"], [1, \"flex\", \"justify-between\", \"items-center\", \"p-3\", \"rounded-md\", \"hover:bg-[#1e293b]\", \"transition-colors\", \"border\", \"border-transparent\", \"hover:border-slate-700/50\"], [1, \"text-sm\", \"font-medium\", \"text-gray-200\"], [1, \"text-[10px]\", \"text-gray-400\", \"mt-0.5\"], [1, \"text-xs\", \"font-bold\", 3, \"ngClass\"]],\n        template: function GuardAssignComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ÉµÉµelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\")(3, \"h1\", 2);\n            i0.ÉµÉµtext(4, \"Personnel Deployment\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(5, \"p\", 3);\n            i0.ÉµÉµtext(6, \"Manage security teams and control crowd flow\");\n            i0.ÉµÉµelementEnd()();\n            i0.ÉµÉµelementStart(7, \"div\", 4)(8, \"button\", 5);\n            i0.ÉµÉµlistener(\"click\", function GuardAssignComponent_Template_button_click_8_listener() {\n              return ctx.broadcastMessage();\n            });\n            i0.ÉµÉµtext(9, \" Broadcast Message \");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(10, \"button\", 6);\n            i0.ÉµÉµnamespaceSVG();\n            i0.ÉµÉµelementStart(11, \"svg\", 7);\n            i0.ÉµÉµelement(12, \"path\", 8);\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµtext(13, \" Add Unit \");\n            i0.ÉµÉµelementEnd()()();\n            i0.ÉµÉµnamespaceHTML();\n            i0.ÉµÉµelementStart(14, \"div\", 9)(15, \"div\", 10)(16, \"app-glass-card\", 11)(17, \"div\", 12);\n            i0.ÉµÉµnamespaceSVG();\n            i0.ÉµÉµelementStart(18, \"svg\", 13);\n            i0.ÉµÉµelement(19, \"path\", 14)(20, \"path\", 15);\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµnamespaceHTML();\n            i0.ÉµÉµelementStart(21, \"h3\", 16);\n            i0.ÉµÉµtext(22, \"Monitored Zones\");\n            i0.ÉµÉµelementEnd()();\n            i0.ÉµÉµelementStart(23, \"div\", 17);\n            i0.ÉµÉµtemplate(24, GuardAssignComponent_div_24_Template, 18, 17, \"div\", 18);\n            i0.ÉµÉµelementEnd()()();\n            i0.ÉµÉµelementStart(25, \"div\", 19)(26, \"app-glass-card\", 11)(27, \"div\", 12);\n            i0.ÉµÉµnamespaceSVG();\n            i0.ÉµÉµelementStart(28, \"svg\", 20);\n            i0.ÉµÉµelement(29, \"path\", 21);\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµnamespaceHTML();\n            i0.ÉµÉµelementStart(30, \"h3\", 16);\n            i0.ÉµÉµtext(31, \"Live Roster\");\n            i0.ÉµÉµelementEnd()();\n            i0.ÉµÉµelementStart(32, \"div\", 22)(33, \"span\");\n            i0.ÉµÉµtext(34, \"Officer Info\");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(35, \"span\");\n            i0.ÉµÉµtext(36, \"Status\");\n            i0.ÉµÉµelementEnd()();\n            i0.ÉµÉµtemplate(37, GuardAssignComponent_div_37_Template, 4, 0, \"div\", 23);\n            i0.ÉµÉµelementStart(38, \"div\", 24);\n            i0.ÉµÉµtemplate(39, GuardAssignComponent_div_39_Template, 8, 9, \"div\", 25);\n            i0.ÉµÉµelementEnd()()()()();\n          }\n          if (rf & 2) {\n            i0.ÉµÉµadvance(24);\n            i0.ÉµÉµproperty(\"ngForOf\", ctx.zones);\n            i0.ÉµÉµadvance(13);\n            i0.ÉµÉµproperty(\"ngIf\", ctx.guards.length === 0);\n            i0.ÉµÉµadvance(2);\n            i0.ÉµÉµproperty(\"ngForOf\", ctx.guards);\n          }\n        },\n        dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.NgSelectOption, i3.ÉµNgSelectMultipleOption, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i4.GlassCardComponent]\n      });\n    }\n  }\n  return GuardAssignComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}