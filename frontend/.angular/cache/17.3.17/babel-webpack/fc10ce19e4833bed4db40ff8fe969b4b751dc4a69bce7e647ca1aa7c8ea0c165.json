{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/api.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../../../shared/glass-card/glass-card.component\";\nfunction GuardRegisterComponent_option_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.…µ…µelementStart(0, \"option\", 14);\n    i0.…µ…µtext(1);\n    i0.…µ…µelementEnd();\n  }\n  if (rf & 2) {\n    const gate_r1 = ctx.$implicit;\n    i0.…µ…µproperty(\"value\", gate_r1);\n    i0.…µ…µadvance();\n    i0.…µ…µtextInterpolate(gate_r1);\n  }\n}\nexport let GuardRegisterComponent = /*#__PURE__*/(() => {\n  class GuardRegisterComponent {\n    constructor(apiService) {\n      this.apiService = apiService;\n      this.guardName = '';\n      this.mobileNumber = '';\n      this.assignedGate = '';\n      this.gates = ['Gate 1', 'Gate 2', 'Gate 3', 'Gate 4', 'Gate 5'];\n      // --- NEW: Multi-tenant Account ID ---\n      this.userEmail = '';\n    }\n    ngOnInit() {\n      // 1. Securely fetch the logged-in user's email from browser memory\n      this.userEmail = localStorage.getItem('userEmail') || '';\n    }\n    registerGuard() {\n      // 1. Check if fields are empty\n      if (!this.guardName || !this.mobileNumber || !this.assignedGate) {\n        alert('Please fill in all the fields!');\n        return;\n      }\n      // üîí Security Check: Make sure email exists\n      if (!this.userEmail) {\n        alert('Security Lock: Please Logout and Login again to sync your account.');\n        return;\n      }\n      // 2. Format the data for the Python Backend WITH EMAIL\n      const newGuard = {\n        name: this.guardName,\n        mobile: this.mobileNumber,\n        gate: this.assignedGate,\n        status: 'Active',\n        user_email: this.userEmail // <-- THIS MAGIC KEY FIXES THE 422 ERROR!\n      };\n      // 3. Send to Database\n      this.apiService.addGuard(newGuard).subscribe({\n        next: response => {\n          // Clear the form\n          this.guardName = '';\n          this.mobileNumber = '';\n          this.assignedGate = '';\n          // Tell the table to update\n          this.apiService.notifyGuardsUpdated();\n          // Show success message\n          alert('‚úÖ Guard successfully registered to your account!');\n        },\n        error: error => {\n          console.error('Error saving guard:', error);\n          alert('‚ùå Failed to save to database. Check console for details.');\n        }\n      });\n    }\n    static {\n      this.…µfac = function GuardRegisterComponent_Factory(t) {\n        return new (t || GuardRegisterComponent)(i0.…µ…µdirectiveInject(i1.ApiService));\n      };\n    }\n    static {\n      this.…µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n        type: GuardRegisterComponent,\n        selectors: [[\"app-guard-register\"]],\n        decls: 26,\n        vars: 4,\n        consts: [[1, \"text-xl\", \"font-medium\", \"text-gray-200\", \"mb-6\", \"tracking-wide\"], [1, \"space-y-5\"], [1, \"block\", \"text-sm\", \"font-medium\", \"text-gray-400\", \"mb-1\"], [\"type\", \"text\", \"placeholder\", \"Enter Guard's Name\", 1, \"w-full\", \"bg-[#0f172a]/80\", \"border\", \"border-slate-600/50\", \"rounded-lg\", \"px-4\", \"py-2.5\", \"text-gray-200\", \"placeholder-gray-600\", \"focus:outline-none\", \"focus:border-blue-500\", \"focus:ring-1\", \"focus:ring-blue-500\", \"transition-all\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"placeholder\", \"+91 9xxxx xxxxx\", 1, \"w-full\", \"bg-[#0f172a]/80\", \"border\", \"border-slate-600/50\", \"rounded-lg\", \"px-4\", \"py-2.5\", \"text-gray-200\", \"placeholder-gray-600\", \"focus:outline-none\", \"focus:border-blue-500\", \"focus:ring-1\", \"focus:ring-blue-500\", \"transition-all\", 3, \"ngModelChange\", \"ngModel\"], [1, \"relative\"], [1, \"w-full\", \"bg-[#0f172a]/80\", \"border\", \"border-slate-600/50\", \"rounded-lg\", \"px-4\", \"py-2.5\", \"text-gray-200\", \"focus:outline-none\", \"focus:border-blue-500\", \"focus:ring-1\", \"focus:ring-blue-500\", \"transition-all\", \"appearance-none\", \"cursor-pointer\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"pointer-events-none\", \"absolute\", \"inset-y-0\", \"right-0\", \"flex\", \"items-center\", \"px-4\", \"text-gray-400\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", \"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"h-4\", \"w-4\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M19 9l-7 7-7-7\"], [1, \"pt-2\"], [1, \"w-full\", \"bg-gradient-to-b\", \"from-[#3b82f6]\", \"to-[#1d4ed8]\", \"hover:from-[#60a5fa]\", \"hover:to-[#2563eb]\", \"border\", \"border-blue-400/30\", \"text-white\", \"font-medium\", \"py-3\", \"rounded-lg\", \"shadow-[0_0_15px_rgba(59,130,246,0.2)]\", \"transition-all\", \"duration-300\", \"active:scale-[0.98]\", 3, \"click\"], [3, \"value\"]],\n        template: function GuardRegisterComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.…µ…µelementStart(0, \"app-glass-card\")(1, \"h2\", 0);\n            i0.…µ…µtext(2, \"Register New Guard\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(3, \"div\", 1)(4, \"div\")(5, \"label\", 2);\n            i0.…µ…µtext(6, \"Full Name\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(7, \"input\", 3);\n            i0.…µ…µtwoWayListener(\"ngModelChange\", function GuardRegisterComponent_Template_input_ngModelChange_7_listener($event) {\n              i0.…µ…µtwoWayBindingSet(ctx.guardName, $event) || (ctx.guardName = $event);\n              return $event;\n            });\n            i0.…µ…µelementEnd()();\n            i0.…µ…µelementStart(8, \"div\")(9, \"label\", 2);\n            i0.…µ…µtext(10, \"Mobile Number\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(11, \"input\", 4);\n            i0.…µ…µtwoWayListener(\"ngModelChange\", function GuardRegisterComponent_Template_input_ngModelChange_11_listener($event) {\n              i0.…µ…µtwoWayBindingSet(ctx.mobileNumber, $event) || (ctx.mobileNumber = $event);\n              return $event;\n            });\n            i0.…µ…µelementEnd()();\n            i0.…µ…µelementStart(12, \"div\")(13, \"label\", 2);\n            i0.…µ…µtext(14, \"Assign Gate\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(15, \"div\", 5)(16, \"select\", 6);\n            i0.…µ…µtwoWayListener(\"ngModelChange\", function GuardRegisterComponent_Template_select_ngModelChange_16_listener($event) {\n              i0.…µ…µtwoWayBindingSet(ctx.assignedGate, $event) || (ctx.assignedGate = $event);\n              return $event;\n            });\n            i0.…µ…µelementStart(17, \"option\", 7);\n            i0.…µ…µtext(18, \"Select a Gate\");\n            i0.…µ…µelementEnd();\n            i0.…µ…µtemplate(19, GuardRegisterComponent_option_19_Template, 2, 2, \"option\", 8);\n            i0.…µ…µelementEnd();\n            i0.…µ…µelementStart(20, \"div\", 9);\n            i0.…µ…µnamespaceSVG();\n            i0.…µ…µelementStart(21, \"svg\", 10);\n            i0.…µ…µelement(22, \"path\", 11);\n            i0.…µ…µelementEnd()()()();\n            i0.…µ…µnamespaceHTML();\n            i0.…µ…µelementStart(23, \"div\", 12)(24, \"button\", 13);\n            i0.…µ…µlistener(\"click\", function GuardRegisterComponent_Template_button_click_24_listener() {\n              return ctx.registerGuard();\n            });\n            i0.…µ…µtext(25, \" Register Guard \");\n            i0.…µ…µelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.…µ…µadvance(7);\n            i0.…µ…µtwoWayProperty(\"ngModel\", ctx.guardName);\n            i0.…µ…µadvance(4);\n            i0.…µ…µtwoWayProperty(\"ngModel\", ctx.mobileNumber);\n            i0.…µ…µadvance(5);\n            i0.…µ…µtwoWayProperty(\"ngModel\", ctx.assignedGate);\n            i0.…µ…µadvance(3);\n            i0.…µ…µproperty(\"ngForOf\", ctx.gates);\n          }\n        },\n        dependencies: [i2.NgForOf, i3.NgSelectOption, i3.…µNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i4.GlassCardComponent]\n      });\n    }\n  }\n  return GuardRegisterComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}