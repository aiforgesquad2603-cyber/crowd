{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ApiService {\n  constructor(http) {\n    this.http = http;\n    // This is your Python FastAPI backend URL\n    this.apiUrl = 'http://localhost:8000/api/guards';\n    // This helps our Guard List auto-refresh when we add a new guard!\n    this.guardsUpdated = new BehaviorSubject(true);\n    this.guardsUpdated$ = this.guardsUpdated.asObservable();\n  }\n  // ðŸ”’ MAGIC FUNCTION: Gets your unique account email securely from browser\n  getUserEmail() {\n    return localStorage.getItem('userEmail') || '';\n  }\n  // --- ACCOUNT BASED APIs ---\n  // 1. Get all guards from MongoDB (ONLY FOR THIS USER)\n  getGuards() {\n    const email = this.getUserEmail();\n    // Attaching user_email to the URL fixes the 422 Error!\n    return this.http.get(`${this.apiUrl}?user_email=${email}`);\n  }\n  // 2. Send a new guard to MongoDB\n  addGuard(guardData) {\n    // Safety check: Attach email if it's missing in the data\n    if (!guardData.user_email) {\n      guardData.user_email = this.getUserEmail();\n    }\n    return this.http.post(this.apiUrl, guardData);\n  }\n  // 3. Delete a guard\n  deleteGuard(id) {\n    return this.http.delete(`${this.apiUrl}/${id}`);\n  }\n  // 4. Tell the app to refresh the table\n  notifyGuardsUpdated() {\n    this.guardsUpdated.next(true);\n  }\n  static {\n    this.Éµfac = function ApiService_Factory(t) {\n      return new (t || ApiService)(i0.ÉµÉµinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.Éµprov = /*@__PURE__*/i0.ÉµÉµdefineInjectable({\n      token: ApiService,\n      factory: ApiService.Éµfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","ApiService","constructor","http","apiUrl","guardsUpdated","guardsUpdated$","asObservable","getUserEmail","localStorage","getItem","getGuards","email","get","addGuard","guardData","user_email","post","deleteGuard","id","delete","notifyGuardsUpdated","next","i0","ÉµÉµinject","i1","HttpClient","factory","Éµfac","providedIn"],"sources":["C:\\Users\\sanja\\OneDrive\\Desktop\\crowdguardai\\frontend\\src\\app\\services\\api.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { BehaviorSubject, Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ApiService {\n  \n  // This is your Python FastAPI backend URL\n  private apiUrl = 'http://localhost:8000/api/guards';\n\n  // This helps our Guard List auto-refresh when we add a new guard!\n  private guardsUpdated = new BehaviorSubject<boolean>(true);\n  guardsUpdated$ = this.guardsUpdated.asObservable();\n\n  constructor(private http: HttpClient) { }\n\n  // ðŸ”’ MAGIC FUNCTION: Gets your unique account email securely from browser\n  private getUserEmail(): string {\n    return localStorage.getItem('userEmail') || '';\n  }\n\n  // --- ACCOUNT BASED APIs ---\n\n  // 1. Get all guards from MongoDB (ONLY FOR THIS USER)\n  getGuards(): Observable<any> {\n    const email = this.getUserEmail();\n    // Attaching user_email to the URL fixes the 422 Error!\n    return this.http.get(`${this.apiUrl}?user_email=${email}`);\n  }\n\n  // 2. Send a new guard to MongoDB\n  addGuard(guardData: any): Observable<any> {\n    // Safety check: Attach email if it's missing in the data\n    if (!guardData.user_email) {\n      guardData.user_email = this.getUserEmail();\n    }\n    return this.http.post(this.apiUrl, guardData);\n  }\n\n  // 3. Delete a guard\n  deleteGuard(id: string): Observable<any> {\n    return this.http.delete(`${this.apiUrl}/${id}`);\n  }\n\n  // 4. Tell the app to refresh the table\n  notifyGuardsUpdated() {\n    this.guardsUpdated.next(true);\n  }\n}"],"mappings":"AAEA,SAASA,eAAe,QAAoB,MAAM;;;AAKlD,OAAM,MAAOC,UAAU;EASrBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IAPxB;IACQ,KAAAC,MAAM,GAAG,kCAAkC;IAEnD;IACQ,KAAAC,aAAa,GAAG,IAAIL,eAAe,CAAU,IAAI,CAAC;IAC1D,KAAAM,cAAc,GAAG,IAAI,CAACD,aAAa,CAACE,YAAY,EAAE;EAEV;EAExC;EACQC,YAAYA,CAAA;IAClB,OAAOC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE;EAChD;EAEA;EAEA;EACAC,SAASA,CAAA;IACP,MAAMC,KAAK,GAAG,IAAI,CAACJ,YAAY,EAAE;IACjC;IACA,OAAO,IAAI,CAACL,IAAI,CAACU,GAAG,CAAC,GAAG,IAAI,CAACT,MAAM,eAAeQ,KAAK,EAAE,CAAC;EAC5D;EAEA;EACAE,QAAQA,CAACC,SAAc;IACrB;IACA,IAAI,CAACA,SAAS,CAACC,UAAU,EAAE;MACzBD,SAAS,CAACC,UAAU,GAAG,IAAI,CAACR,YAAY,EAAE;IAC5C;IACA,OAAO,IAAI,CAACL,IAAI,CAACc,IAAI,CAAC,IAAI,CAACb,MAAM,EAAEW,SAAS,CAAC;EAC/C;EAEA;EACAG,WAAWA,CAACC,EAAU;IACpB,OAAO,IAAI,CAAChB,IAAI,CAACiB,MAAM,CAAC,GAAG,IAAI,CAAChB,MAAM,IAAIe,EAAE,EAAE,CAAC;EACjD;EAEA;EACAE,mBAAmBA,CAAA;IACjB,IAAI,CAAChB,aAAa,CAACiB,IAAI,CAAC,IAAI,CAAC;EAC/B;;;uBA1CWrB,UAAU,EAAAsB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;EAAA;;;aAAVzB,UAAU;MAAA0B,OAAA,EAAV1B,UAAU,CAAA2B,IAAA;MAAAC,UAAA,EAFT;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}